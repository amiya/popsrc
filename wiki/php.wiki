= 快速链接 =
  * [#Install 安装]
  * [#Upgrade 升级]
  * [#Manage 常用管理命令]
  * [#Config 配置]
    * [#Config_file 配置文件路径]
    * [#Hide_version 隐藏版本号]
    * [#Config_Example 常用配置]


----

= Install =

前置条件
{{{
# 安装需要的第三方库
yum -y install libxml2 libxml2-devel curl curl-devel libjpeg libjpeg-devel libpng libpng-devel libmcrypt libmcrypt-devel
}}}

安装 php-5.3.9 (fast cgi 方式)
{{{
mkdir -p /root/software
cd /root/software
wget http://cn.php.net/distributions/php-5.3.9.tar.gz
tar zxvf php-5.3.9.tar.gz
cd php-5.3.9
./configure --prefix=/usr/local/php --enable-fpm --with-curl --with-mcrypt --enable-mbstring --with-iconv --with-gd --with-jpeg-dir --with-zlib --with-mysql=mysqlnd --with-mysqli=mysqlnd --enable-pdo --with-pdo-mysql=mysqlnd --enable-sockets --enable-pcntl --enable-shmop --enable-sysvsem --with-openssl
make && make install

# 复制 php-fpm 控制脚本
cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm
chmod +x /etc/init.d/php-fpm    # 设置为可执行
chkconfig --add php-fpm         # 设置为系统服务

# 复制 php.ini
cp php.ini-production /usr/local/php/lib/php.ini

# 复制 php-fpm.conf
cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf

# 修改 php.ini


# 修改 php-fpm.conf
}}}

----

= Upgrade =

前置条件
{{{
# 查看当前版本号
/usr/local/php/bin/php -v

# 查看当前版本的编译参数
/usr/local/php/bin/php -i | grep configure

# 停止 php (如果正在执行中)
service php-fpm stop

# 修改当前版本的目录名
mv /usr/local/php/ /usr/local/php-old/
}}}

升级到 php-5.3.10 (fast cgi 方式)
{{{
cd /root/software
wget http://cn.php.net/distributions/php-5.3.10.tar.gz
tar zxvf php-5.3.10.tar.gz
cd php-5.3.10

# 使用旧版本的编译参数 (或者其它参数)
./configure [编译参数]
make && make install

# 使用旧的 php.ini
cp /usr/local/php-old/lib/php.ini /usr/local/php/lib/php.ini

# 使用旧的 php-fpm.conf
cp /usr/local/php-old/etc/php-fpm.conf /usr/local/php/etc/php-fpm.conf

# 查看安装是否成功
/usr/local/php/bin/php -v

# 安装扩展
# ...

# 启动 fast cgi
service php-fpm start
}}}


= Config =

== Config Example ==
常用配置
{{{
# 安全设置
cgi.fix_pathinfo = 0

# 隐藏 php
expose_php = Off

# 时区
date.timezone = "Asia/Shanghai"

# 错误提示
display_error = Off	(生产机)
display_error = On	(测试机)

# 启用扩展
# ...
}}}
}}}